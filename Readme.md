本Readmeは[本作品初出展時のウェブサイト](http://openrtm.sakura.ne.jp/cgi-bin/wiki/wiki.cgi/2009/1A36?page=FrontPage)を簡略化したものです。

# 概要

## 開発の背景

コンポーネント指向によるRTシステムの開発や運用に際しては、開発したコンポーネントやそれらを統合したシステムが様々な入力に対して正常に動作するかを確認するための動作テストや、移動ロボットの経路やロボットアームの目標姿勢といったアクチュエータへの指令の生成などが必要であり、効率的に入力データを作成することが望まれます。このような背景から、ユーザが様々なパターンの入力データを生成することが可能なファンクションジェネレータコンポーネントを開発することといたしました。

## 動作概要

ファンクションジェネレータコンポーネントは、数学関数や事前に保存したデータ列を指定することで様々なパターンの入力データを生成することが可能な入力データ生成コンポーネントです。出力データの生成方法は大きく分けて2通りあります。まず、コンフィギュレーションパラメータから出力したいデータを数学関数によって指定することが可能です。また、ファンクションジェネレータコンポーネントにはInPortに入力されたデータを記録する機能も備えており、予めセンサ出力などを保存しておき、そのデータを読み込み出力することも可能です。

# 利用方法

ここでは、ファンクションジェネレータコンポーネント(FunctionGenerator)の基本的な使い方と利用例を紹介しています。コンポーネントの仕様、使い方の詳細に関しましては付属のマニュアルに記述されておりますのでそちらをご覧ください。

## FunctionGeneratorの使用手順
FunctionGeneratorには大きく分けて2つの使い方があります。
1. 数学関数を出力する
1. データをファイルに保存し、そのデータを読み込んで出力する
いずれの場合においても、FunctionGeneratorは指定されたデータを順次OutPortから出力します。このときのコンポーネントの実行周期はrtc.confのexec_cxt.periodic.rateの値で設定することができます。

### 基本的な使い方(1) -数学関数出力機能の利用-
まず、数学関数を入力し、それを出力する機能について説明します。この使用手順をまとめると以下のようになります。
- 出力する関数の設定
1. Configurationを設定する
	1. 変数のパラメータxMin, xMax, xDelta, tMin, tMax, tDeltaを設定する
	1. outputFunctionOrLoadFileNameに出力する関数を設定する
1. OutPortをデータを与えたいコンポーネントと接続する
1. コンポーネントをアクティブ化する

利用可能な関数、演算子、定数、変数は以下の通りです。

関数

| 関数名 | 引数の数 | 定義域 | 説明 |
|:---:|:---:|:---:|:---|
| abs    | 1 | -∞ < x < ∞            | 引数xの絶対値を計算する。 |
| acos   | 1 | -1 ≦ x ≦ 1            | 引数xの逆余弦の主値[0，π] [rad]を計算する。 |
| asin   | 1 | -1 ≦ x ≦ 1            | 引数xの逆正弦の主値[-π/2，π/2] [rad]を計算する。 |
| atan   | 1 | -∞ < x < ∞            | 引数xの逆正接の主値[-π/2，π/2] [rad]を計算する。 |
| atan2  | 2 | x1≠0またはx2≠0        | 引数x1/x2の逆正接の主値[-π，π] [rad]を計算する。このとき、引数の符号を用いて返却値の象限を決定する。 |
| ceil   | 1 | -∞ < x < ∞            | 引数x以上の最小の整数値を計算する。 |
| cos    | 1 | -∞ < x < ∞            | 引数x [rad]の余弦を計算する。 |
| cosh   | 1 | -∞ < x < ∞            | 引数xの双曲線余弦を計算する。 |
| exp    | 1 | -∞ < x < ∞            | ネイピア数（自然対数の底）eのべき乗e^xを計算する。 |
| floor  | 1 | -∞ < x < ∞            | 引数x以下の最大の整数値を計算する。 |
| ln     | 1 | 0 < x < ∞              | 引数xの自然対数を計算する。 |
| log    | 1 | 0 < x < ∞              | 引数xの常用対数を計算する。 |
| random | 0 | -                       | 乱数[0，1]を返す。 |
| sign   | 1 | -∞ < x < ∞            | 引数xの符号を表す値を返す。関数の値はxが負のとき-1、0のとき0、正のとき1となる。 |
| sin    | 1 | -∞ < x < ∞            | 引数x [rad]の正弦を計算する。 |
| sinh   | 1 | -∞ < x < ∞            | 引数xの双曲線正弦を計算する。 |
| sqrt   | 1 | 0 ≦ x < ∞             | 引数xの非負の平方根を計算する。 |
| tan    | 1 | x≠(π/2)+nπ (nは整数) | 引数x [rad]の正接を計算する。 |
| tanh   | 1 | -∞ < x < ∞            | 引数xの双曲線正接を計算する。 |

ここでは、定義域の説明において引数をxで表しています。複数の引数がある場合には第1引数から順にx1, x2, ... としています。

演算子

| 優先順位 | 演算子 | 結合 | 説明 |
|:---:|:---:|:---:|:---|
| 1 | ^     | 右 | べき乗。0の非正数乗および負数の非整数乗の場合は定義されない。|
| 2 | 単項+ | 右 | 正の符号。 |
|   | 単項- | 右 | 負の符号。 |
| 3 | *     | 左 | 乗算。 |
|   | /     | 左 | 除算。除数が0である場合は定義されない。 |
|   | %     | 左 | 剰余算。除数が0である場合は定義されない。 |
| 4 | +     | 左 | 加算。 |
|   | -     | 左 | 減算。 |

また、この他に、演算順序を指定するための左括弧'('および右括弧')'を使用することができます。

定数 

| 定数名 | 説明 |
|:---:|:---|
| pi | 円周率π=3.141592...。 |
| e  | ネイピア数（自然対数の底）e=2.71828...。|

変数

| 変数名 | 説明 |
|:---:|:---|
| x | 1組の出力データにおいて、xMinを初期値とし、値がxMaxを超えるまでxDeltaずつ増加する。 |
| t | tMinを初期値とし、コンポーネントの周期ごとにtDeltaずつ増加する。値がtMaxを超えるとtMinに戻る。 |

### 基本的な使い方(2) -ファイル出力機能の利用-
次に、出力データをファイルに保存しておき、それを出力する機能について説明します。ファイルを自分で作成することも可能ですが、FunctionGeneratorにはファイル作成の手間を低減するため、他のコンポーネントから入力ポートに入力されたデータを保存できる機能も備えています。この使用手順をまとめると以下のようになります。
- ファイルの作成
1. Configurationを設定する
	1. ファイルの保存形式saveFileModeを設定する
	1. 保存するファイル名saveFileNameを設定する
2. InPortをデータを保存するコンポーネントと接続する
3. コンポーネントをアクティブ化する

- ファイルの読み込み
1. Configurationを設定する
	1. outputFunctionOrLoadFileNameに読み込むファイル名を設定する
1. OutPortをデータを与えたいコンポーネントと接続する
1. コンポーネントをアクティブ化する
